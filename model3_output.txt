Using Theano backend.
Couldn't import dot_parser, loading of dot files will not be possible.
/Library/Python/2.7/site-packages/keras/utils/np_utils.py:16: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  Y[i, y[i]] = 1.
64x32 model
epoch 1/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.3662 - acc: 0.8836Epoch 00000: val_loss improved from inf to 0.12104, saving model to weights5.hdf5
36000/36000 [==============================] - 130s - loss: 0.3661 - acc: 0.8836 - val_loss: 0.1210 - val_acc: 0.9617
epoch 2/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.1013 - acc: 0.9684Epoch 00000: val_loss improved from 0.12104 to 0.09388, saving model to weights5.hdf5
36000/36000 [==============================] - 125s - loss: 0.1014 - acc: 0.9684 - val_loss: 0.0939 - val_acc: 0.9715
epoch 3/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0731 - acc: 0.9777Epoch 00000: val_loss improved from 0.09388 to 0.05863, saving model to weights5.hdf5
36000/36000 [==============================] - 125s - loss: 0.0731 - acc: 0.9777 - val_loss: 0.0586 - val_acc: 0.9822
epoch 4/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0572 - acc: 0.9819Epoch 00000: val_loss improved from 0.05863 to 0.04833, saving model to weights5.hdf5
36000/36000 [==============================] - 124s - loss: 0.0573 - acc: 0.9819 - val_loss: 0.0483 - val_acc: 0.9838
epoch 5/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0487 - acc: 0.9852Epoch 00000: val_loss improved from 0.04833 to 0.04428, saving model to weights5.hdf5
36000/36000 [==============================] - 126s - loss: 0.0487 - acc: 0.9852 - val_loss: 0.0443 - val_acc: 0.9852
epoch 6/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0410 - acc: 0.9870Epoch 00000: val_loss improved from 0.04428 to 0.04039, saving model to weights5.hdf5
36000/36000 [==============================] - 128s - loss: 0.0409 - acc: 0.9870 - val_loss: 0.0404 - val_acc: 0.9870
epoch 7/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0368 - acc: 0.9885Epoch 00000: val_loss improved from 0.04039 to 0.03414, saving model to weights5.hdf5
36000/36000 [==============================] - 121s - loss: 0.0367 - acc: 0.9886 - val_loss: 0.0341 - val_acc: 0.9890
epoch 8/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0326 - acc: 0.9901Epoch 00000: val_loss improved from 0.03414 to 0.03133, saving model to weights5.hdf5
36000/36000 [==============================] - 121s - loss: 0.0326 - acc: 0.9901 - val_loss: 0.0313 - val_acc: 0.9905
epoch 9/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0294 - acc: 0.9907Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 129s - loss: 0.0295 - acc: 0.9907 - val_loss: 0.0335 - val_acc: 0.9882
epoch 10/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0265 - acc: 0.9915Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 139s - loss: 0.0265 - acc: 0.9915 - val_loss: 0.0325 - val_acc: 0.9905
epoch 11/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0233 - acc: 0.9922Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 131s - loss: 0.0233 - acc: 0.9922 - val_loss: 0.0382 - val_acc: 0.9892
epoch 12/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0212 - acc: 0.9930Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 84s - loss: 0.0212 - acc: 0.9931 - val_loss: 0.0326 - val_acc: 0.9890
epoch 13/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0193 - acc: 0.9936Epoch 00000: val_loss improved from 0.03133 to 0.03006, saving model to weights5.hdf5
36000/36000 [==============================] - 79s - loss: 0.0193 - acc: 0.9936 - val_loss: 0.0301 - val_acc: 0.9902
epoch 14/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0184 - acc: 0.9937Epoch 00000: val_loss improved from 0.03006 to 0.02649, saving model to weights5.hdf5
36000/36000 [==============================] - 72s - loss: 0.0184 - acc: 0.9937 - val_loss: 0.0265 - val_acc: 0.9912
epoch 15/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0173 - acc: 0.9942Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 74s - loss: 0.0173 - acc: 0.9942 - val_loss: 0.0270 - val_acc: 0.9912
epoch 16/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0140 - acc: 0.9953Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 77s - loss: 0.0140 - acc: 0.9953 - val_loss: 0.0302 - val_acc: 0.9918
epoch 17/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0142 - acc: 0.9952Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 93s - loss: 0.0142 - acc: 0.9952 - val_loss: 0.0286 - val_acc: 0.9900
epoch 18/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0131 - acc: 0.9953Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 108s - loss: 0.0131 - acc: 0.9953 - val_loss: 0.0321 - val_acc: 0.9902
epoch 19/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0132 - acc: 0.9957Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 102s - loss: 0.0132 - acc: 0.9957 - val_loss: 0.0289 - val_acc: 0.9915
epoch 20/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0103 - acc: 0.9967Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 101s - loss: 0.0102 - acc: 0.9967 - val_loss: 0.0297 - val_acc: 0.9908
epoch 21/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0109 - acc: 0.9962Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 102s - loss: 0.0109 - acc: 0.9962 - val_loss: 0.0326 - val_acc: 0.9910
epoch 22/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0111 - acc: 0.9961Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 102s - loss: 0.0111 - acc: 0.9961 - val_loss: 0.0311 - val_acc: 0.9912
epoch 23/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0099 - acc: 0.9967Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 77s - loss: 0.0099 - acc: 0.9967 - val_loss: 0.0308 - val_acc: 0.9908
epoch 24/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0093 - acc: 0.9968Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 96s - loss: 0.0093 - acc: 0.9968 - val_loss: 0.0302 - val_acc: 0.9915
epoch 25/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0081 - acc: 0.9975Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 107s - loss: 0.0081 - acc: 0.9975 - val_loss: 0.0282 - val_acc: 0.9925
epoch 26/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0079 - acc: 0.9972Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 102s - loss: 0.0079 - acc: 0.9972 - val_loss: 0.0360 - val_acc: 0.9915
epoch 27/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0080 - acc: 0.9972Epoch 00000: val_loss improved from 0.02649 to 0.02644, saving model to weights5.hdf5
36000/36000 [==============================] - 105s - loss: 0.0080 - acc: 0.9972 - val_loss: 0.0264 - val_acc: 0.9912
epoch 28/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0081 - acc: 0.9972Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 131s - loss: 0.0081 - acc: 0.9972 - val_loss: 0.0315 - val_acc: 0.9918
epoch 29/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0070 - acc: 0.9978Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 128s - loss: 0.0070 - acc: 0.9978 - val_loss: 0.0328 - val_acc: 0.9928
epoch 30/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0066 - acc: 0.9977Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 132s - loss: 0.0066 - acc: 0.9977 - val_loss: 0.0355 - val_acc: 0.9922
epoch 31/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0065 - acc: 0.9975Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 136s - loss: 0.0065 - acc: 0.9975 - val_loss: 0.0359 - val_acc: 0.9915
epoch 32/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0063 - acc: 0.9977Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 122s - loss: 0.0063 - acc: 0.9978 - val_loss: 0.0331 - val_acc: 0.9920
epoch 33/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0055 - acc: 0.9982Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 108s - loss: 0.0055 - acc: 0.9982 - val_loss: 0.0309 - val_acc: 0.9922
epoch 34/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0052 - acc: 0.9981Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 113s - loss: 0.0052 - acc: 0.9981 - val_loss: 0.0365 - val_acc: 0.9918
epoch 35/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0057 - acc: 0.9980Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 121s - loss: 0.0057 - acc: 0.9980 - val_loss: 0.0279 - val_acc: 0.9918
epoch 36/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0045 - acc: 0.9985Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 119s - loss: 0.0045 - acc: 0.9985 - val_loss: 0.0348 - val_acc: 0.9915
epoch 37/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0060 - acc: 0.9981Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 125s - loss: 0.0060 - acc: 0.9981 - val_loss: 0.0300 - val_acc: 0.9915
epoch 38/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0048 - acc: 0.9981Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 134s - loss: 0.0048 - acc: 0.9981 - val_loss: 0.0265 - val_acc: 0.9920
epoch 39/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0041 - acc: 0.9985Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 113s - loss: 0.0041 - acc: 0.9985 - val_loss: 0.0303 - val_acc: 0.9922
epoch 40/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0045 - acc: 0.9984Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 122s - loss: 0.0045 - acc: 0.9984 - val_loss: 0.0298 - val_acc: 0.9930
epoch 41/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0043 - acc: 0.9986Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 134s - loss: 0.0043 - acc: 0.9986 - val_loss: 0.0313 - val_acc: 0.9922
epoch 42/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0047 - acc: 0.9985Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 129s - loss: 0.0047 - acc: 0.9985 - val_loss: 0.0325 - val_acc: 0.9922
epoch 43/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0044 - acc: 0.9984Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 133s - loss: 0.0044 - acc: 0.9984 - val_loss: 0.0313 - val_acc: 0.9920
epoch 44/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0039 - acc: 0.9986Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 126s - loss: 0.0039 - acc: 0.9986 - val_loss: 0.0337 - val_acc: 0.9920
epoch 45/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0036 - acc: 0.9987Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 113s - loss: 0.0036 - acc: 0.9988 - val_loss: 0.0359 - val_acc: 0.9918
epoch 46/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0036 - acc: 0.9989Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 122s - loss: 0.0036 - acc: 0.9989 - val_loss: 0.0340 - val_acc: 0.9932
epoch 47/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0038 - acc: 0.9987Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 132s - loss: 0.0038 - acc: 0.9987 - val_loss: 0.0316 - val_acc: 0.9910
epoch 48/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0036 - acc: 0.9986Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 116s - loss: 0.0036 - acc: 0.9986 - val_loss: 0.0348 - val_acc: 0.9928
epoch 49/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0033 - acc: 0.9988Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 114s - loss: 0.0033 - acc: 0.9988 - val_loss: 0.0302 - val_acc: 0.9932
epoch 50/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0036 - acc: 0.9988Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 116s - loss: 0.0036 - acc: 0.9988 - val_loss: 0.0344 - val_acc: 0.9925
Test score: 0.0264359876208
Test accuracy: 0.99125
-----------
Val1 score: 0.0403908101374
Val1 accuracy: 0.9905
-----------
Val2 score: 0.0352891334509
Val2 accuracy: 0.9922
done took 5776 sec
