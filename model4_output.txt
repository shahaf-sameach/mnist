Using Theano backend.
Couldn't import dot_parser, loading of dot files will not be possible.
/Library/Python/2.7/site-packages/keras/utils/np_utils.py:16: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  Y[i, y[i]] = 1.
32x32 model
epoch 1/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.4036 - acc: 0.8714Epoch 00000: val_loss improved from inf to 0.16037, saving model to weights10.hdf5
36000/36000 [==============================] - 72s - loss: 0.4034 - acc: 0.8715 - val_loss: 0.1604 - val_acc: 0.9490
epoch 2/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.1161 - acc: 0.9640Epoch 00000: val_loss improved from 0.16037 to 0.07424, saving model to weights10.hdf5
36000/36000 [==============================] - 75s - loss: 0.1162 - acc: 0.9640 - val_loss: 0.0742 - val_acc: 0.9755
epoch 3/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0852 - acc: 0.9734Epoch 00000: val_loss improved from 0.07424 to 0.05425, saving model to weights10.hdf5
36000/36000 [==============================] - 77s - loss: 0.0853 - acc: 0.9734 - val_loss: 0.0542 - val_acc: 0.9822
epoch 4/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0662 - acc: 0.9784Epoch 00000: val_loss improved from 0.05425 to 0.04641, saving model to weights10.hdf5
36000/36000 [==============================] - 89s - loss: 0.0662 - acc: 0.9784 - val_loss: 0.0464 - val_acc: 0.9845
epoch 5/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0544 - acc: 0.9826Epoch 00000: val_loss improved from 0.04641 to 0.03963, saving model to weights10.hdf5
36000/36000 [==============================] - 84s - loss: 0.0544 - acc: 0.9826 - val_loss: 0.0396 - val_acc: 0.9868
epoch 6/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0470 - acc: 0.9855Epoch 00000: val_loss improved from 0.03963 to 0.03794, saving model to weights10.hdf5
36000/36000 [==============================] - 82s - loss: 0.0470 - acc: 0.9855 - val_loss: 0.0379 - val_acc: 0.9865
epoch 7/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0415 - acc: 0.9873Epoch 00000: val_loss improved from 0.03794 to 0.03623, saving model to weights10.hdf5
36000/36000 [==============================] - 81s - loss: 0.0416 - acc: 0.9872 - val_loss: 0.0362 - val_acc: 0.9888
epoch 8/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0389 - acc: 0.9880Epoch 00000: val_loss improved from 0.03623 to 0.03287, saving model to weights10.hdf5
36000/36000 [==============================] - 85s - loss: 0.0389 - acc: 0.9880 - val_loss: 0.0329 - val_acc: 0.9895
epoch 9/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0340 - acc: 0.9888Epoch 00000: val_loss improved from 0.03287 to 0.03104, saving model to weights10.hdf5
36000/36000 [==============================] - 83s - loss: 0.0341 - acc: 0.9888 - val_loss: 0.0310 - val_acc: 0.9898
epoch 10/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0317 - acc: 0.9895Epoch 00000: val_loss improved from 0.03104 to 0.03074, saving model to weights10.hdf5
36000/36000 [==============================] - 82s - loss: 0.0317 - acc: 0.9895 - val_loss: 0.0307 - val_acc: 0.9898
epoch 11/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0282 - acc: 0.9910Epoch 00000: val_loss improved from 0.03074 to 0.02803, saving model to weights10.hdf5
36000/36000 [==============================] - 82s - loss: 0.0282 - acc: 0.9910 - val_loss: 0.0280 - val_acc: 0.9900
epoch 12/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0265 - acc: 0.9913Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 83s - loss: 0.0264 - acc: 0.9913 - val_loss: 0.0312 - val_acc: 0.9895
epoch 13/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0251 - acc: 0.9920Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 82s - loss: 0.0250 - acc: 0.9920 - val_loss: 0.0296 - val_acc: 0.9900
epoch 14/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0234 - acc: 0.9926Epoch 00000: val_loss improved from 0.02803 to 0.02630, saving model to weights10.hdf5
36000/36000 [==============================] - 84s - loss: 0.0234 - acc: 0.9926 - val_loss: 0.0263 - val_acc: 0.9922
epoch 15/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0213 - acc: 0.9930Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 85s - loss: 0.0213 - acc: 0.9930 - val_loss: 0.0277 - val_acc: 0.9905
epoch 16/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0202 - acc: 0.9933Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 81s - loss: 0.0202 - acc: 0.9933 - val_loss: 0.0286 - val_acc: 0.9908
epoch 17/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0190 - acc: 0.9942Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 78s - loss: 0.0190 - acc: 0.9942 - val_loss: 0.0285 - val_acc: 0.9915
epoch 18/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0181 - acc: 0.9937Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 77s - loss: 0.0181 - acc: 0.9938 - val_loss: 0.0280 - val_acc: 0.9902
epoch 19/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0170 - acc: 0.9942Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 83s - loss: 0.0170 - acc: 0.9942 - val_loss: 0.0290 - val_acc: 0.9898
epoch 20/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0155 - acc: 0.9946Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 80s - loss: 0.0155 - acc: 0.9946 - val_loss: 0.0283 - val_acc: 0.9922
epoch 21/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0158 - acc: 0.9951Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 80s - loss: 0.0158 - acc: 0.9951 - val_loss: 0.0274 - val_acc: 0.9922
epoch 22/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0145 - acc: 0.9954Epoch 00000: val_loss improved from 0.02630 to 0.02559, saving model to weights10.hdf5
36000/36000 [==============================] - 80s - loss: 0.0145 - acc: 0.9954 - val_loss: 0.0256 - val_acc: 0.9915
epoch 23/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0136 - acc: 0.9954Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 84s - loss: 0.0136 - acc: 0.9954 - val_loss: 0.0280 - val_acc: 0.9918
epoch 24/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0111 - acc: 0.9964Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 73s - loss: 0.0110 - acc: 0.9964 - val_loss: 0.0284 - val_acc: 0.9910
epoch 25/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0120 - acc: 0.9960Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 73s - loss: 0.0120 - acc: 0.9960 - val_loss: 0.0264 - val_acc: 0.9920
epoch 26/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0110 - acc: 0.9960Epoch 00000: val_loss improved from 0.02559 to 0.02427, saving model to weights10.hdf5
36000/36000 [==============================] - 74s - loss: 0.0110 - acc: 0.9960 - val_loss: 0.0243 - val_acc: 0.9915
epoch 27/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0106 - acc: 0.9966Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 74s - loss: 0.0106 - acc: 0.9966 - val_loss: 0.0254 - val_acc: 0.9918
epoch 28/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0100 - acc: 0.9964Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 73s - loss: 0.0100 - acc: 0.9964 - val_loss: 0.0270 - val_acc: 0.9915
epoch 29/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0102 - acc: 0.9965Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 72s - loss: 0.0102 - acc: 0.9965 - val_loss: 0.0268 - val_acc: 0.9918
epoch 30/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0083 - acc: 0.9970Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 72s - loss: 0.0083 - acc: 0.9970 - val_loss: 0.0277 - val_acc: 0.9922
epoch 31/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0088 - acc: 0.9969Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 84s - loss: 0.0088 - acc: 0.9969 - val_loss: 0.0283 - val_acc: 0.9928
epoch 32/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0089 - acc: 0.9970Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 79s - loss: 0.0089 - acc: 0.9970 - val_loss: 0.0279 - val_acc: 0.9915
epoch 33/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0084 - acc: 0.9971Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 76s - loss: 0.0084 - acc: 0.9971 - val_loss: 0.0288 - val_acc: 0.9915
epoch 34/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0089 - acc: 0.9967Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 75s - loss: 0.0089 - acc: 0.9967 - val_loss: 0.0306 - val_acc: 0.9912
epoch 35/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0068 - acc: 0.9976Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 78s - loss: 0.0068 - acc: 0.9976 - val_loss: 0.0340 - val_acc: 0.9908
epoch 36/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0081 - acc: 0.9973Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 76s - loss: 0.0081 - acc: 0.9973 - val_loss: 0.0313 - val_acc: 0.9912
epoch 37/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0067 - acc: 0.9977Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 79s - loss: 0.0067 - acc: 0.9977 - val_loss: 0.0289 - val_acc: 0.9922
epoch 38/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0065 - acc: 0.9978Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 77s - loss: 0.0065 - acc: 0.9978 - val_loss: 0.0266 - val_acc: 0.9920
epoch 39/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0066 - acc: 0.9978Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 78s - loss: 0.0066 - acc: 0.9978 - val_loss: 0.0299 - val_acc: 0.9915
epoch 40/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0069 - acc: 0.9978Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 65s - loss: 0.0068 - acc: 0.9978 - val_loss: 0.0266 - val_acc: 0.9925
epoch 41/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0063 - acc: 0.9979Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 47s - loss: 0.0063 - acc: 0.9979 - val_loss: 0.0267 - val_acc: 0.9922
epoch 42/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0068 - acc: 0.9975Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 54s - loss: 0.0068 - acc: 0.9975 - val_loss: 0.0284 - val_acc: 0.9928
epoch 43/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0066 - acc: 0.9978Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 50s - loss: 0.0066 - acc: 0.9978 - val_loss: 0.0264 - val_acc: 0.9925
epoch 44/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0056 - acc: 0.9983Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 50s - loss: 0.0056 - acc: 0.9983 - val_loss: 0.0321 - val_acc: 0.9915
epoch 45/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0055 - acc: 0.9978Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 53s - loss: 0.0055 - acc: 0.9978 - val_loss: 0.0304 - val_acc: 0.9922
epoch 46/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0046 - acc: 0.9983Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 63s - loss: 0.0046 - acc: 0.9983 - val_loss: 0.0283 - val_acc: 0.9912
epoch 47/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0047 - acc: 0.9984Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 72s - loss: 0.0047 - acc: 0.9984 - val_loss: 0.0342 - val_acc: 0.9910
epoch 48/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0051 - acc: 0.9981Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 77s - loss: 0.0051 - acc: 0.9981 - val_loss: 0.0278 - val_acc: 0.9925
epoch 49/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0055 - acc: 0.9981Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 74s - loss: 0.0055 - acc: 0.9981 - val_loss: 0.0277 - val_acc: 0.9918
epoch 50/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0052 - acc: 0.9982Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 76s - loss: 0.0052 - acc: 0.9982 - val_loss: 0.0326 - val_acc: 0.9912
Test score: 0.0242713872093
Test accuracy: 0.9915
-----------
Val1 score: 0.039324943506
Val1 accuracy: 0.9899
-----------
Val2 score: 0.0348950229516
Val2 accuracy: 0.991
done took 3824 sec
