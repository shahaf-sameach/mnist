Using Theano backend.
Couldn't import dot_parser, loading of dot files will not be possible.
/Library/Python/2.7/site-packages/keras/utils/np_utils.py:16: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  Y[i, y[i]] = 1.
relu 750
epoch 1/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.3238 - acc: 0.8981Epoch 00000: val_loss improved from inf to 0.10727, saving model to weights1.hdf5
36000/36000 [==============================] - 85s - loss: 0.3238 - acc: 0.8981 - val_loss: 0.1073 - val_acc: 0.9657
epoch 2/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0849 - acc: 0.9739Epoch 00000: val_loss improved from 0.10727 to 0.07499, saving model to weights1.hdf5
36000/36000 [==============================] - 86s - loss: 0.0849 - acc: 0.9739 - val_loss: 0.0750 - val_acc: 0.9770
epoch 3/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0592 - acc: 0.9818Epoch 00000: val_loss improved from 0.07499 to 0.05004, saving model to weights1.hdf5
36000/36000 [==============================] - 85s - loss: 0.0591 - acc: 0.9818 - val_loss: 0.0500 - val_acc: 0.9832
epoch 4/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0468 - acc: 0.9854Epoch 00000: val_loss improved from 0.05004 to 0.04697, saving model to weights1.hdf5
36000/36000 [==============================] - 85s - loss: 0.0469 - acc: 0.9854 - val_loss: 0.0470 - val_acc: 0.9855
epoch 5/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0371 - acc: 0.9884Epoch 00000: val_loss improved from 0.04697 to 0.04083, saving model to weights1.hdf5
36000/36000 [==============================] - 85s - loss: 0.0371 - acc: 0.9883 - val_loss: 0.0408 - val_acc: 0.9870
epoch 6/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0331 - acc: 0.9890Epoch 00000: val_loss improved from 0.04083 to 0.03938, saving model to weights1.hdf5
36000/36000 [==============================] - 83s - loss: 0.0332 - acc: 0.9890 - val_loss: 0.0394 - val_acc: 0.9872
epoch 7/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0269 - acc: 0.9917Epoch 00000: val_loss improved from 0.03938 to 0.03378, saving model to weights1.hdf5
36000/36000 [==============================] - 83s - loss: 0.0269 - acc: 0.9917 - val_loss: 0.0338 - val_acc: 0.9880
epoch 8/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0246 - acc: 0.9924Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 82s - loss: 0.0246 - acc: 0.9924 - val_loss: 0.0347 - val_acc: 0.9898
epoch 9/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0209 - acc: 0.9931Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 80s - loss: 0.0209 - acc: 0.9931 - val_loss: 0.0400 - val_acc: 0.9888
epoch 10/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0183 - acc: 0.9944Epoch 00000: val_loss improved from 0.03378 to 0.02930, saving model to weights1.hdf5
36000/36000 [==============================] - 82s - loss: 0.0183 - acc: 0.9944 - val_loss: 0.0293 - val_acc: 0.9902
epoch 11/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0169 - acc: 0.9944Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 82s - loss: 0.0169 - acc: 0.9944 - val_loss: 0.0297 - val_acc: 0.9900
epoch 12/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0142 - acc: 0.9955Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 82s - loss: 0.0142 - acc: 0.9955 - val_loss: 0.0357 - val_acc: 0.9898
epoch 13/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0130 - acc: 0.9959Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 82s - loss: 0.0130 - acc: 0.9959 - val_loss: 0.0367 - val_acc: 0.9890
epoch 14/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0128 - acc: 0.9959Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 81s - loss: 0.0127 - acc: 0.9959 - val_loss: 0.0337 - val_acc: 0.9900
epoch 15/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0101 - acc: 0.9966Epoch 00000: val_loss improved from 0.02930 to 0.02754, saving model to weights1.hdf5
36000/36000 [==============================] - 81s - loss: 0.0101 - acc: 0.9966 - val_loss: 0.0275 - val_acc: 0.9915
epoch 16/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0089 - acc: 0.9973Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 81s - loss: 0.0089 - acc: 0.9973 - val_loss: 0.0285 - val_acc: 0.9918
epoch 17/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0079 - acc: 0.9972Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 81s - loss: 0.0079 - acc: 0.9972 - val_loss: 0.0413 - val_acc: 0.9902
epoch 18/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0075 - acc: 0.9975Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 81s - loss: 0.0075 - acc: 0.9975 - val_loss: 0.0324 - val_acc: 0.9912
epoch 19/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0074 - acc: 0.9975Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 81s - loss: 0.0074 - acc: 0.9975 - val_loss: 0.0347 - val_acc: 0.9908
epoch 20/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0064 - acc: 0.9977Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 81s - loss: 0.0064 - acc: 0.9978 - val_loss: 0.0334 - val_acc: 0.9905
epoch 21/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0058 - acc: 0.9978Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 81s - loss: 0.0058 - acc: 0.9978 - val_loss: 0.0364 - val_acc: 0.9900
epoch 22/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0050 - acc: 0.9983Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 81s - loss: 0.0050 - acc: 0.9983 - val_loss: 0.0375 - val_acc: 0.9905
epoch 23/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0063 - acc: 0.9980Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 85s - loss: 0.0063 - acc: 0.9980 - val_loss: 0.0310 - val_acc: 0.9915
epoch 24/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0048 - acc: 0.9985Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 95s - loss: 0.0048 - acc: 0.9985 - val_loss: 0.0416 - val_acc: 0.9915
epoch 25/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0042 - acc: 0.9987Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 90s - loss: 0.0042 - acc: 0.9987 - val_loss: 0.0385 - val_acc: 0.9912
epoch 26/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0042 - acc: 0.9984Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 91s - loss: 0.0041 - acc: 0.9984 - val_loss: 0.0349 - val_acc: 0.9908
epoch 27/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0041 - acc: 0.9982Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 88s - loss: 0.0041 - acc: 0.9983 - val_loss: 0.0317 - val_acc: 0.9912
epoch 28/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0048 - acc: 0.9986Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 91s - loss: 0.0048 - acc: 0.9986 - val_loss: 0.0360 - val_acc: 0.9912
epoch 29/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0034 - acc: 0.9989Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 90s - loss: 0.0034 - acc: 0.9989 - val_loss: 0.0365 - val_acc: 0.9918
epoch 30/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0025 - acc: 0.9992Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 88s - loss: 0.0025 - acc: 0.9992 - val_loss: 0.0357 - val_acc: 0.9918
epoch 31/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0028 - acc: 0.9990Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 89s - loss: 0.0028 - acc: 0.9990 - val_loss: 0.0380 - val_acc: 0.9898
epoch 32/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0030 - acc: 0.9990Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 86s - loss: 0.0030 - acc: 0.9990 - val_loss: 0.0394 - val_acc: 0.9908
epoch 33/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0024 - acc: 0.9992Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 87s - loss: 0.0024 - acc: 0.9992 - val_loss: 0.0377 - val_acc: 0.9912
epoch 34/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0034 - acc: 0.9991Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 85s - loss: 0.0034 - acc: 0.9991 - val_loss: 0.0398 - val_acc: 0.9915
epoch 35/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0023 - acc: 0.9992Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 95s - loss: 0.0023 - acc: 0.9992 - val_loss: 0.0521 - val_acc: 0.9908
epoch 36/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0026 - acc: 0.9991Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 82s - loss: 0.0026 - acc: 0.9991 - val_loss: 0.0463 - val_acc: 0.9912
epoch 37/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0019 - acc: 0.9993Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 84s - loss: 0.0019 - acc: 0.9993 - val_loss: 0.0365 - val_acc: 0.9905
epoch 38/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0024 - acc: 0.9991Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 88s - loss: 0.0024 - acc: 0.9991 - val_loss: 0.0409 - val_acc: 0.9920
epoch 39/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0023 - acc: 0.9993Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 86s - loss: 0.0023 - acc: 0.9993 - val_loss: 0.0371 - val_acc: 0.9925
epoch 40/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0020 - acc: 0.9994Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 83s - loss: 0.0020 - acc: 0.9994 - val_loss: 0.0481 - val_acc: 0.9902
epoch 41/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0014 - acc: 0.9996Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 91s - loss: 0.0014 - acc: 0.9996 - val_loss: 0.0383 - val_acc: 0.9920
epoch 42/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0017 - acc: 0.9994Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 93s - loss: 0.0017 - acc: 0.9994 - val_loss: 0.0400 - val_acc: 0.9908
epoch 43/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0019 - acc: 0.9993Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 91s - loss: 0.0019 - acc: 0.9993 - val_loss: 0.0426 - val_acc: 0.9908
epoch 44/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0017 - acc: 0.9995Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 87s - loss: 0.0017 - acc: 0.9995 - val_loss: 0.0463 - val_acc: 0.9918
epoch 45/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0017 - acc: 0.9993Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 88s - loss: 0.0017 - acc: 0.9993 - val_loss: 0.0390 - val_acc: 0.9922
epoch 46/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0014 - acc: 0.9996Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 90s - loss: 0.0014 - acc: 0.9996 - val_loss: 0.0425 - val_acc: 0.9925
epoch 47/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0024 - acc: 0.9992Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 91s - loss: 0.0024 - acc: 0.9992 - val_loss: 0.0371 - val_acc: 0.9920
epoch 48/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0018 - acc: 0.9996Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 90s - loss: 0.0018 - acc: 0.9996 - val_loss: 0.0368 - val_acc: 0.9928
epoch 49/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0016 - acc: 0.9993Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 82s - loss: 0.0016 - acc: 0.9993 - val_loss: 0.0468 - val_acc: 0.9922
epoch 50/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0014 - acc: 0.9995Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 79s - loss: 0.0014 - acc: 0.9995 - val_loss: 0.0412 - val_acc: 0.9915
Test score: 0.0275372015311
Test accuracy: 0.9915
-----------
Val1 score: 0.0375988149965
Val1 accuracy: 0.99
-----------
Val2 score: 0.0325333905811
Val2 accuracy: 0.9922
done took 4317 sec
