Using Theano backend.
Couldn't import dot_parser, loading of dot files will not be possible.
/Library/Python/2.7/site-packages/keras/utils/np_utils.py:16: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  Y[i, y[i]] = 1.
64x64 model without elastic distortion
epoch 1/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.3416 - acc: 0.8917Epoch 00000: val_loss improved from inf to 0.10035, saving model to weights1.hdf5
36000/36000 [==============================] - 129s - loss: 0.3416 - acc: 0.8917 - val_loss: 0.1003 - val_acc: 0.9692
epoch 2/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0930 - acc: 0.9705Epoch 00000: val_loss improved from 0.10035 to 0.06962, saving model to weights1.hdf5
36000/36000 [==============================] - 127s - loss: 0.0930 - acc: 0.9704 - val_loss: 0.0696 - val_acc: 0.9775
epoch 3/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0670 - acc: 0.9791Epoch 00000: val_loss improved from 0.06962 to 0.05798, saving model to weights1.hdf5
36000/36000 [==============================] - 133s - loss: 0.0670 - acc: 0.9791 - val_loss: 0.0580 - val_acc: 0.9818
epoch 4/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0507 - acc: 0.9840Epoch 00000: val_loss improved from 0.05798 to 0.04945, saving model to weights1.hdf5
36000/36000 [==============================] - 161s - loss: 0.0508 - acc: 0.9840 - val_loss: 0.0494 - val_acc: 0.9835
epoch 5/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0418 - acc: 0.9867Epoch 00000: val_loss improved from 0.04945 to 0.03942, saving model to weights1.hdf5
36000/36000 [==============================] - 160s - loss: 0.0418 - acc: 0.9867 - val_loss: 0.0394 - val_acc: 0.9882
epoch 6/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0364 - acc: 0.9885Epoch 00000: val_loss improved from 0.03942 to 0.03444, saving model to weights1.hdf5
36000/36000 [==============================] - 165s - loss: 0.0364 - acc: 0.9885 - val_loss: 0.0344 - val_acc: 0.9892
epoch 7/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0319 - acc: 0.9898Epoch 00000: val_loss improved from 0.03444 to 0.03359, saving model to weights1.hdf5
36000/36000 [==============================] - 152s - loss: 0.0319 - acc: 0.9897 - val_loss: 0.0336 - val_acc: 0.9895
epoch 8/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0284 - acc: 0.9912Epoch 00000: val_loss improved from 0.03359 to 0.03258, saving model to weights1.hdf5
36000/36000 [==============================] - 133s - loss: 0.0284 - acc: 0.9911 - val_loss: 0.0326 - val_acc: 0.9888
epoch 9/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0251 - acc: 0.9919Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 147s - loss: 0.0251 - acc: 0.9919 - val_loss: 0.0333 - val_acc: 0.9905
epoch 10/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0226 - acc: 0.9934Epoch 00000: val_loss improved from 0.03258 to 0.02770, saving model to weights1.hdf5
36000/36000 [==============================] - 144s - loss: 0.0226 - acc: 0.9934 - val_loss: 0.0277 - val_acc: 0.9920
epoch 11/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0203 - acc: 0.9932Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 154s - loss: 0.0202 - acc: 0.9932 - val_loss: 0.0368 - val_acc: 0.9875
epoch 12/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0181 - acc: 0.9937Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 163s - loss: 0.0181 - acc: 0.9938 - val_loss: 0.0326 - val_acc: 0.9898
epoch 13/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0165 - acc: 0.9940Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 136s - loss: 0.0165 - acc: 0.9940 - val_loss: 0.0299 - val_acc: 0.9912
epoch 14/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0145 - acc: 0.9953Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 158s - loss: 0.0145 - acc: 0.9953 - val_loss: 0.0314 - val_acc: 0.9900
epoch 15/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0135 - acc: 0.9956Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 162s - loss: 0.0135 - acc: 0.9956 - val_loss: 0.0305 - val_acc: 0.9915
epoch 16/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0132 - acc: 0.9959Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 165s - loss: 0.0132 - acc: 0.9959 - val_loss: 0.0298 - val_acc: 0.9908
epoch 17/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0102 - acc: 0.9968Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 153s - loss: 0.0102 - acc: 0.9968 - val_loss: 0.0348 - val_acc: 0.9900
epoch 18/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0100 - acc: 0.9966Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 144s - loss: 0.0099 - acc: 0.9966 - val_loss: 0.0326 - val_acc: 0.9902
epoch 19/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0101 - acc: 0.9967Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 161s - loss: 0.0101 - acc: 0.9967 - val_loss: 0.0307 - val_acc: 0.9915
epoch 20/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0094 - acc: 0.9969Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 144s - loss: 0.0094 - acc: 0.9969 - val_loss: 0.0295 - val_acc: 0.9925
epoch 21/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0088 - acc: 0.9967Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 139s - loss: 0.0088 - acc: 0.9967 - val_loss: 0.0315 - val_acc: 0.9918
epoch 22/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0072 - acc: 0.9973Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 136s - loss: 0.0072 - acc: 0.9973 - val_loss: 0.0323 - val_acc: 0.9915
epoch 23/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0070 - acc: 0.9976Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 109s - loss: 0.0070 - acc: 0.9976 - val_loss: 0.0308 - val_acc: 0.9920
epoch 24/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0067 - acc: 0.9976Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 107s - loss: 0.0067 - acc: 0.9976 - val_loss: 0.0331 - val_acc: 0.9915
epoch 25/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0056 - acc: 0.9980Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 100s - loss: 0.0056 - acc: 0.9980 - val_loss: 0.0444 - val_acc: 0.9898
epoch 26/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0055 - acc: 0.9981Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 101s - loss: 0.0055 - acc: 0.9981 - val_loss: 0.0355 - val_acc: 0.9915
epoch 27/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0058 - acc: 0.9980Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 106s - loss: 0.0058 - acc: 0.9980 - val_loss: 0.0328 - val_acc: 0.9915
epoch 28/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0054 - acc: 0.9982Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 100s - loss: 0.0054 - acc: 0.9982 - val_loss: 0.0366 - val_acc: 0.9915
epoch 29/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0056 - acc: 0.9982Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 97s - loss: 0.0056 - acc: 0.9982 - val_loss: 0.0337 - val_acc: 0.9925
epoch 30/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0044 - acc: 0.9986Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 104s - loss: 0.0044 - acc: 0.9986 - val_loss: 0.0356 - val_acc: 0.9915
epoch 31/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0040 - acc: 0.9986Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 118s - loss: 0.0040 - acc: 0.9986 - val_loss: 0.0360 - val_acc: 0.9918
epoch 32/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0044 - acc: 0.9982Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 147s - loss: 0.0044 - acc: 0.9982 - val_loss: 0.0318 - val_acc: 0.9910
epoch 33/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0039 - acc: 0.9987Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 161s - loss: 0.0039 - acc: 0.9987 - val_loss: 0.0374 - val_acc: 0.9922
epoch 34/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0047 - acc: 0.9983Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 183s - loss: 0.0047 - acc: 0.9983 - val_loss: 0.0328 - val_acc: 0.9918
epoch 35/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0035 - acc: 0.9987Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 174s - loss: 0.0035 - acc: 0.9987 - val_loss: 0.0380 - val_acc: 0.9915
epoch 36/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0040 - acc: 0.9986Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 175s - loss: 0.0040 - acc: 0.9986 - val_loss: 0.0397 - val_acc: 0.9918
epoch 37/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0034 - acc: 0.9986Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 174s - loss: 0.0034 - acc: 0.9986 - val_loss: 0.0408 - val_acc: 0.9910
epoch 38/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0046 - acc: 0.9986Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 173s - loss: 0.0046 - acc: 0.9986 - val_loss: 0.0335 - val_acc: 0.9922
epoch 39/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0032 - acc: 0.9989Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 177s - loss: 0.0032 - acc: 0.9989 - val_loss: 0.0338 - val_acc: 0.9920
epoch 40/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0026 - acc: 0.9991Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 164s - loss: 0.0026 - acc: 0.9991 - val_loss: 0.0377 - val_acc: 0.9912
epoch 41/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0030 - acc: 0.9989Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 171s - loss: 0.0030 - acc: 0.9989 - val_loss: 0.0371 - val_acc: 0.9915
epoch 42/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0036 - acc: 0.9987Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 170s - loss: 0.0036 - acc: 0.9988 - val_loss: 0.0345 - val_acc: 0.9918
epoch 43/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0028 - acc: 0.9991Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 162s - loss: 0.0028 - acc: 0.9991 - val_loss: 0.0360 - val_acc: 0.9910
epoch 44/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0028 - acc: 0.9990Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 151s - loss: 0.0028 - acc: 0.9990 - val_loss: 0.0409 - val_acc: 0.9918
epoch 45/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0022 - acc: 0.9993Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 150s - loss: 0.0022 - acc: 0.9993 - val_loss: 0.0382 - val_acc: 0.9905
epoch 46/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0026 - acc: 0.9990Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 160s - loss: 0.0026 - acc: 0.9990 - val_loss: 0.0394 - val_acc: 0.9912
epoch 47/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0023 - acc: 0.9994Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 167s - loss: 0.0023 - acc: 0.9994 - val_loss: 0.0388 - val_acc: 0.9922
epoch 48/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0021 - acc: 0.9992Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 161s - loss: 0.0021 - acc: 0.9992 - val_loss: 0.0400 - val_acc: 0.9910
epoch 49/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0025 - acc: 0.9991Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 165s - loss: 0.0025 - acc: 0.9991 - val_loss: 0.0436 - val_acc: 0.9908
epoch 50/50:
Train on 36000 samples, validate on 4000 samples
Epoch 1/1
35968/36000 [============================>.] - ETA: 0s - loss: 0.0017 - acc: 0.9995Epoch 00000: val_loss did not improve
36000/36000 [==============================] - 164s - loss: 0.0017 - acc: 0.9995 - val_loss: 0.0347 - val_acc: 0.9918
Test score: 0.0276971585389
Test accuracy: 0.992
-----------
Val1 score: 0.0336958000491
Val1 accuracy: 0.9902
-----------
Val2 score: 0.0328881162391
Val2 accuracy: 0.9908
done took 7412 sec
